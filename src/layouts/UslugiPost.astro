---
import Base from '@layouts/Base.astro';
import { Image } from 'astro:assets';
import { getEntryBySlug } from 'astro:content';
import FormattedDate from '@components/FormattedDate.astro';
import HeroService from '@components/HeroService.astro';
import CalendarIcon from '@icons/CalendarIcon.astro';
import CategoryIcon from '@icons/CategoryIcon.astro';
import config from '@config/config.json';
import Banners from '@components/Banners.astro';
import ServiceMethod from '@components/ServiceMethod.astro';
import Features from '@components/Features.astro';
import type { CollectionEntry } from 'astro:content';
import { slugify } from '@utils/slug';
import MyForm from '@components/MyForm.astro';

const homepage = await getEntryBySlug('homepage', 'index');
const { features } = homepage.data;

type Props = CollectionEntry<'uslugi'>['data'];

const {
  title,
  description,
  pubDate,
  descr,
  heroImage,
  categories,
  tags,
  icon,
  box,
  min_price,
  h_one,
  list_services,
  banners,
  our_service,
} = Astro.props;
---

<Base meta_title={title} {description} image={heroImage} uslugipost>
  <article>
    <HeroService {heroImage} {descr} {h_one} {icon} {box} {min_price} {list_services} />
    <Banners {banners} />
    <div class="mx-2 my-12 lg:my-24">
      <Features {features} />
    </div>
    <ServiceMethod {our_service} />

    <div class="max-w-full bg-gradient-to-br from-sky-700/10 via-cyan-700/10 to-teal-700/10 py-14 text-center">
      <div class="gradientBg mx-auto max-w-3xl rounded-xl p-14 text-center shadow-lg">
        <MyForm form_name={h_one} id_number="second_form" />
      </div>
    </div>

    <div
      class="prose prose-lg prose-green mx-2 my-16 flex max-w-7xl flex-col md:prose-lg lg:mx-auto lg:my-24 lg:flex-row"
    >
      <div class="basis-full lg:basis-1/5">
        <div class="sticky top-24 mt-8">
          {
            list_services.map((service: any) => (
              <a href={service.url_id} class="">
                <div class="block rounded-lg px-4 py-2 text-xl font-bold text-cyan-700/100 hover:bg-zinc-50 hover:text-teal-700 dark:text-white/100 dark:hover:bg-teal-200 dark:hover:text-teal-800">
                  {service.name}
                </div>
              </a>
            ))
          }
        </div>
      </div>
      <div class="basis-full lg:basis-3/5">
        <slot />
      </div>
      <div class="basis-full lg:basis-1/5">
        <div class="sticky top-24 mx-4 mt-8 rounded-xl bg-white p-4 shadow-lg lg:p-8">
          <p class="text-center text-xl font-semibold">Заказать услугу</p>
          <a href="#toTheForm" class="relative flex h-16 w-24 items-center justify-center"
            ><div
              class="gradientBgBtn absolute flex h-full w-full animate-ping items-center justify-center rounded-full opacity-75"
            >
            </div><div
              class="gradientBgBtn hover:gradientBgNimb text-md z-10 flex w-full items-center justify-center gap-x-3 rounded-lg border border-transparent text-center font-semibold text-white transition lg:text-lg"
            >
              Заказать
            </div></a
          >
        </div>
      </div>
    </div>
  </article>
</Base>
